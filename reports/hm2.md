# Домашнее задание 2

Расчёт метрик (5 баллов)

    Функция будет принимать на вход:
    1.1 Словарь с инициализированными моделями
    1.2 Словарь с инициализированными метриками
    1.3 Инициализированный Splitter для кросс-валидации
    1.4 Количество рекомендаций для генерации (K)
    Реализация обучения и валидации:
    1.1 Создаем RecTools Dataset через метод construct на train взаимодействиях для каждого фолда
    1.2 Обучаем модель (не забываем сделать deepcopy), рекоменуем K айтемов для каждого юзера, считаем метрики на test
    1.3 Дополнительно логируем время обучения
    1.4 Сохраняем метрики в отчёт
    Результат оборачиваем в pandas DataFrame и усредняем по фолдам

Визуальный анализ (5 баллов)

    Функция будет принимать на вход:
    1.1 Инициализированную (и обученную!) модель
    1.2 Датасет
    1.3 Список отобранных user_id для просмотра
    1.4 item_data - данные об айтемах, которые важно отразить для визуального анализа (напр. название)
    Реализация:
    1.1 Генерим рекомендации для отобранных user_id
    1.2 Получаем из датасета истории просмотров юзеров
    1.3 Отображаем в любом удобном виде, который позволит смотреть на историю просмотра юзера + на его рекомендации от модели

Для тестирования функций используем:

    Модели: rectools.models.RandomModel(random_state=32), rectools.models.PopularModel() с параметрами по умолчанию
    Метрики: 2 ранжирующие, 2 классификационные, 2 beyond-accuracy. Считаем по порогам 1, 5, 10. MAP обязательно
    Сплиттер: rectools.model_selection.TimeRangeSplitter, 3 фолда для кросс-валидации по неделе, исключение холодных юзеров и айтемов и просмотренных айтемов
    Визуализация рекомендаций и историй просмотров для юзеров [666262, 672861, 955527]. Для айтемов обязательно отражаем названия, жанры и количество просмотров в датасете (как для айтемов из истории взаимодействий каждого юзера, так и для айтемов из его рекомендаций)
